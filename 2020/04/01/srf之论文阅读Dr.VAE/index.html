<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="srf之论文阅读Dr.VAE"><meta name="keywords" content="srf"><meta name="author" content="Rr-shan,undefined"><meta name="copyright" content="Rr-shan"><title>srf之论文阅读Dr.VAE【Sanzzi】</title><link rel="stylesheet" href="../../../../css/fan.css"><link rel="stylesheet" href="../../../../css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="icon" href="../../../../favicon.ico"><!-- script(src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML")--><script src="../../../../js/mathjax/mathjax.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('请输入文章密码') !== '') {
        alert('密码错误！');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
}</script></head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="toggle-sidebar-info button-hover"><span data-toggle="文章目录">站点概览</span></div><div class="sidebar-toc"><div class="sidebar-toc-title">目录</div><div class="sidebar-toc-progress"><span class="progress-notice">您已阅读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc-progress-bar"></div></div><div class="sidebar-toc-content" id="sidebar-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Dr-VAE-improving-drug-response-prediction-via-modeling-of-drug-perturbation-effects"><span class="toc-number">1.</span> <span class="toc-text">Dr.VAE: improving drug response prediction via modeling of drug perturbation effects</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-为什么要讲这个"><span class="toc-number">1.1.</span> <span class="toc-text">1. 为什么要讲这个?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-提出了什么方法"><span class="toc-number">1.2.</span> <span class="toc-text">2. 提出了什么方法 ?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-传统方法有什么问题-（对比）"><span class="toc-number">1.3.</span> <span class="toc-text">3. 传统方法有什么问题?（对比）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-原理"><span class="toc-number">1.4.</span> <span class="toc-text">4. 原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#简单了解一下VAE"><span class="toc-number">1.4.1.</span> <span class="toc-text">简单了解一下VAE</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#模型图："><span class="toc-number">1.4.1.1.</span> <span class="toc-text">模型图：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#效果（目的）："><span class="toc-number">1.4.1.2.</span> <span class="toc-text">效果（目的）：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#到这里，开始介绍Dr-VAE"><span class="toc-number">1.4.2.</span> <span class="toc-text">到这里，开始介绍Dr.VAE</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#介绍"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#公式："><span class="toc-number">1.4.2.2.</span> <span class="toc-text">公式：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#encoder-amp-decoder层次的设计"><span class="toc-number">1.4.3.</span> <span class="toc-text">encoder&amp;decoder层次的设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#整个参数设计的代码体现"><span class="toc-number">1.4.4.</span> <span class="toc-text">整个参数设计的代码体现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#损失函数"><span class="toc-number">1.4.5.</span> <span class="toc-text">损失函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-数据集是怎么划分的"><span class="toc-number">1.5.</span> <span class="toc-text">5. 数据集是怎么划分的?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#两个数据集的基本介绍："><span class="toc-number">1.5.1.</span> <span class="toc-text">两个数据集的基本介绍：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实验数据选择标准："><span class="toc-number">1.5.2.</span> <span class="toc-text">实验数据选择标准：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-交叉验证怎么做"><span class="toc-number">1.6.</span> <span class="toc-text">7. 交叉验证怎么做?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Discussion："><span class="toc-number">1.7.</span> <span class="toc-text">8. Discussion：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#局限性："><span class="toc-number">1.7.1.</span> <span class="toc-text">局限性：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#补充知识："><span class="toc-number">1.8.</span> <span class="toc-text">补充知识：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ablation-study消融实验"><span class="toc-number">1.8.1.</span> <span class="toc-text">ablation study消融实验:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Result部分"><span class="toc-number">1.8.2.</span> <span class="toc-text">Result部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ELU激活函数"><span class="toc-number">1.8.3.</span> <span class="toc-text">ELU激活函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MMD"><span class="toc-number">1.8.4.</span> <span class="toc-text">MMD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#KL散度"><span class="toc-number">1.8.5.</span> <span class="toc-text">KL散度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#细胞系"><span class="toc-number">1.8.6.</span> <span class="toc-text">细胞系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参考："><span class="toc-number">1.8.7.</span> <span class="toc-text">参考：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#文章："><span class="toc-number">1.8.7.1.</span> <span class="toc-text">文章：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#视频："><span class="toc-number">1.8.7.2.</span> <span class="toc-text">视频：</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/avatar.png"></div><div class="author-info-name">Rr-shan</div><div class="author-info-description"></div><div class="links-buttons"><a class="links-button button-hover" href="https://github.com/Rr-shan" target="_blank">GitHub<i class="icon-dot bg-color9"></i></a><a class="links-button button-hover" href="mailto:1224559633@qq.com" target="_blank">E-Mail<i class="icon-dot bg-color4"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="../../../../archives"><span class="pull-top">日志</span><span class="pull-bottom">47</span></a><a class="author-info-articles-tags article-meta" href="../../../../tags"><span class="pull-top">标签</span><span class="pull-bottom">12</span></a><a class="author-info-articles-categories article-meta" href="../../../../categories"><span class="pull-top">分类</span><span class="pull-bottom">12</span></a></div><div class="friend-link"><a class="friend-link-text" href="https://chao-yin-github.github.io/" target="_blank">yccccc~~~~~~~~</a><a class="friend-link-text" href="https://sanzzi.cn" target="_blank">Mywebsite</a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">首页</a><a class="menu-item" href="/tags">标签</a><a class="menu-item" href="/categories">分类</a><a class="menu-item" href="/archives">归档</a><a class="menu-item" href="/about">关于</a></nav><div class="right-info"><a class="title-name" href="/">Sanzzi</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><div class="post-header"><div class="title">srf之论文阅读Dr.VAE</div><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 发表于 2020-04-01 | 更新于 2020-04-06</time><!--time.button-hover.post-date #[i.fas.fa-calendar-alt.article-icon(aria-hidden="true")] #[=__('post.modified')] #[=date(page['updated'], config.date_format)]--><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="../../../../categories/DeepLearning/">DeepLearning</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="../../../../tags/srf/">srf</a></div></div></div><div class="main-content"><h1 id="Dr-VAE-improving-drug-response-prediction-via-modeling-of-drug-perturbation-effects"><a href="#Dr-VAE-improving-drug-response-prediction-via-modeling-of-drug-perturbation-effects" class="headerlink" title="Dr.VAE: improving drug response prediction via modeling of drug perturbation effects"></a>Dr.VAE: improving drug response prediction via modeling of drug perturbation effects</h1><hr>
<h2 id="1-为什么要讲这个"><a href="#1-为什么要讲这个" class="headerlink" title="1. 为什么要讲这个?"></a>1. 为什么要讲这个?</h2><p><strong>Motivation:</strong><br>将<strong>生物系统的现有知识</strong>融入到这些方法中是<strong>提高预测性能</strong>的一个很有前途的途径。<br><strong>药物诱导转录组扰动效应的高通量细胞系分析</strong>(High-throughput cell line assays of drug-induced transcriptomic perturbation effects)是一项尚未完全纳入药物反应预测模型的先验知识。</p>
<h2 id="2-提出了什么方法"><a href="#2-提出了什么方法" class="headerlink" title="2. 提出了什么方法 ?"></a>2. 提出了什么方法 ?</h2><ul>
<li>药物反应变异自动编码器（<strong>Dr.VAE</strong>）（Drug Response Variational Autoencoder），这是一种<strong>深度生成模型</strong>，可以根据<strong>转录组扰动特征预测药物反应</strong>。Dr.VAE是一个概率图形模型，其中每个条件分布都由一个<strong>深度神经网络</strong>来计算。该模型共同学习药物反应预测因子和基因表达的低维潜在表示中的药物扰动效应生成模型。</li>
<li>结果：对于26种经过美国食品药品监督管理局（FDA）批准的测试药物，<strong>Dr.VAE的性能达到或优于标准分类方法</strong>。<blockquote>
<p>药物诱导转录组扰动效应，为什么谷歌不到相关信息！！？？</p>
</blockquote>
</li>
</ul>
<h2 id="3-传统方法有什么问题-（对比）"><a href="#3-传统方法有什么问题-（对比）" class="headerlink" title="3. 传统方法有什么问题?（对比）"></a>3. 传统方法有什么问题?（对比）</h2><p>在论文Introduction部分，并没有直接说之前的方法存在什么问题，而是罗列已有的成果。(略)<br>补充说一下Dr.VAE这个方法的具体启发：<br>Niepel 等人（2017）从最初的CMap开始研究了六种乳腺癌细胞系的转录组扰动，并结合表型药物反应测量来确定具有相似表型药物反应的细胞系在药物诱导的基因表达扰动中是否也具有相同的模式。<br>他们的分析得出结论，<strong>某些药物（细胞周期激酶抑制剂）就是这种情况，但对于其他药物，分子反应是细胞类型特异性的，对于某些药物-细胞系组合，显着的转录扰动对细胞没有影响</strong>。这些结果促使我们开发出一种统一的方法，该方法可以确定更复杂的分子扰动和表型反应关联，这些关联对于细胞系亚群可能是唯一的。</p>
<p>有关使用VAE的进展</p>
<ul>
<li>Way and Greene（2018）已证明VAE可以提取出癌症转录组谱的生物学意义。</li>
<li>Dincer 等（2018）在名为DeepProfile的药物反应预测方法中结合了<strong>预训练的VAE</strong>和<strong>单独训练的线性模型</strong>。</li>
</ul>
<h2 id="4-原理"><a href="#4-原理" class="headerlink" title="4. 原理"></a>4. 原理</h2><h3 id="简单了解一下VAE"><a href="#简单了解一下VAE" class="headerlink" title="简单了解一下VAE"></a>简单了解一下VAE</h3><h4 id="模型图："><a href="#模型图：" class="headerlink" title="模型图："></a>模型图：</h4><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWctYmJzLmNzZG4ubmV0L3VwbG9hZC8yMDIwMDQvMDYvMTU4NjE3NTMyN18zODU5NzIucG5n?x-oss-process=image/format,png#pic_center" alt="在这里插入图片描述"><br>下面这幅图可能容易理解一些<br><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9rZXh1ZS5mbS91c3IvdXBsb2Fkcy8yMDE4LzAzLzQxNjg4NzY2NjIucG5n?x-oss-process=image/format,png#pic_center" alt="在这里插入图片描述"></p>
<h4 id="效果（目的）："><a href="#效果（目的）：" class="headerlink" title="效果（目的）："></a>效果（目的）：</h4><p><img src="https://img-blog.csdnimg.cn/20190226215534296.png#pic_center" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/2019022621561853.png#pic_center" alt="在这里插入图片描述"></p>
<h3 id="到这里，开始介绍Dr-VAE"><a href="#到这里，开始介绍Dr-VAE" class="headerlink" title="到这里，开始介绍Dr.VAE"></a>到这里，开始介绍Dr.VAE</h3><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWctYmJzLmNzZG4ubmV0L3VwbG9hZC8yMDIwMDQvMDQvMTU4NTk5MzY3OF82MzY0NzEucG5n?x-oss-process=image/format,png#pic_center" alt="在这里插入图片描述"></p>
<h4 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h4><ul>
<li>x1是没有经过药物作用的，也就是没有转录组扰动效应</li>
<li>x2是经过药物作用后的。</li>
<li>z1,z2是隐参数，对于x1,x2</li>
<li>y是显示预测相关性的</li>
<li>z3 class-independent，独立的，正态分布<h4 id="公式："><a href="#公式：" class="headerlink" title="公式："></a>公式：</h4><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWctYmJzLmNzZG4ubmV0L3VwbG9hZC8yMDIwMDQvMDYvMTU4NjE2NjI5NV85OTcxNTIucG5n?x-oss-process=image/format,png#pic_center" alt="在这里插入图片描述"></li>
</ul>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWctYmJzLmNzZG4ubmV0L3VwbG9hZC8yMDIwMDQvMDQvMTU4NTk5MzY4N181MzM3Ny5wbmc?x-oss-process=image/format,png#pic_center" alt="在这里插入图片描述"></p>
<p>图a：Dr.VARE<br>图b:<br>图c:我们需要能够从观察到的形式对<strong>隐藏变量</strong>（z1,z2）进行有效推断变量，我们转向随机变分推断并引入真实<strong>后验的近似值q</strong>。<br>图d:Dr.VARE一点的例子<br>图f： PertVAE：无监督模型，用来研究药物效应模型对学习的潜在基因表达表示的贡献</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWctYmJzLmNzZG4ubmV0L3VwbG9hZC8yMDIwMDQvMDYvMTU4NjE3MTM2NV83MjY5NTYucG5n?x-oss-process=image/format,png#pic_center" alt="在这里插入图片描述"><br>不是很明白为什么这样子会好一些？？？</p>
<hr>
<h3 id="encoder-amp-decoder层次的设计"><a href="#encoder-amp-decoder层次的设计" class="headerlink" title="encoder&amp;decoder层次的设计"></a>encoder&amp;decoder层次的设计</h3><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWctYmJzLmNzZG4ubmV0L3VwbG9hZC8yMDIwMDQvMDYvMTU4NjE3NTI0MV8yOTQ2MTEucG5n?x-oss-process=image/format,png#pic_center" alt="在这里插入图片描述"></p>
<h3 id="整个参数设计的代码体现"><a href="#整个参数设计的代码体现" class="headerlink" title="整个参数设计的代码体现"></a>整个参数设计的<em>代码体现</em></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">model = DrVAE(dim_x=dim_x, dim_s=dim_s, dim_y=dim_y, dim_z1=args.dim_z1, dim_z3=args.dim_z3,</span><br><span class="line">              dim_h_en_z1=args.enc_z1, dim_h_en_z3=args.enc_z3, dim_h_en_z2Fz1=args.enc_z2Fz1,</span><br><span class="line">              dim_h_de_z1=args.dec_z1, dim_h_de_x=args.dec_x, type_rec=<span class="string">'diag_gaussian'</span>,</span><br><span class="line">              dim_h_clf=args.class_y, type_y=args.type_y, prior_y=prior_y,</span><br><span class="line">              optim_alg=<span class="string">'adam'</span>, batch_size=args.batch_size, epochs=<span class="number">300</span>,</span><br><span class="line">              nonlinearity=<span class="string">'elu'</span>, L=args.L,</span><br><span class="line">              weight_decay=<span class="number">0.05</span>, dropout_rate=<span class="number">0.</span>, input_x_dropout=args.x_dropout, add_noise_var=args.noise_var,</span><br><span class="line">              learning_rate=<span class="number">0.0005</span>, yloss_rate=args.yloss_rate, clf_z1z2=<span class="literal">True</span>, clf_1sig=args.clf_1sig,</span><br><span class="line">              anneal_yloss_offset=args.anneal_yloss_offset,</span><br><span class="line">              kl_qz2pz2_rate=<span class="number">1.</span>, pertloss_rate=<span class="number">0.05</span>, anneal_perturb_rate_itermax=<span class="number">1</span>, anneal_perturb_rate_offset=<span class="number">0</span>,</span><br><span class="line">              use_s=args.useS, use_MMD=args.useMMD, kernel_MMD=<span class="string">'rbf_fourier'</span>, mmd_rate=args.mmd_rate,  <span class="comment">## &lt;= settings for "fairness" (like VFAE)</span></span><br><span class="line">              random_seed=args.rseed, log_txt=<span class="literal">None</span>  <span class="comment">#'DrVAE_SD_&#123;&#125;_&#123;&#125;.txt'.format(args.modelid, selected_drug)</span></span><br><span class="line">              )</span><br></pre></td></tr></table></figure>

<h3 id="损失函数"><a href="#损失函数" class="headerlink" title="损失函数"></a>损失函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算KL散度</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_fprop</span><span class="params">(self, z1, qz1, y)</span>:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算所有loss</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_compute_losses</span><span class="params">(self, x1, x2, s, y, L)</span>:</span></span><br><span class="line">   <span class="string">"""     </span></span><br><span class="line"><span class="string">   计算模型的所有损失。 对于未标记的数据，将y边缘化。</span></span><br><span class="line"><span class="string">   Compute all losses of the model. For unlabeled data marginalize y.</span></span><br><span class="line"><span class="string">   RECL - reconstruction loss E_&#123;q(z1|x1)&#125;[ p(x1|z1) ] </span></span><br><span class="line"><span class="string">   KLD  - kl-divergences of all the other matching q and p distributions所有其他匹配q和p分布的kl-散度</span></span><br><span class="line"><span class="string">   PERT - perturbation prediction loss E_&#123;p(z2|z1)q(z1|x1)&#125;[ p(x2|z2) ]</span></span><br><span class="line"><span class="string">   YL   - prediction loss on y (for labeled data)</span></span><br><span class="line"><span class="string">   MMD  - maximum mean discrepancy of z1 embedding w.r.t. grouping s</span></span><br><span class="line"><span class="string">   """</span></span><br></pre></td></tr></table></figure>

<h2 id="5-数据集是怎么划分的"><a href="#5-数据集是怎么划分的" class="headerlink" title="5. 数据集是怎么划分的?"></a>5. 数据集是怎么划分的?</h2><blockquote>
<p><strong>Training data sets</strong>：<strong>CTRPv2</strong>( Cancer Therapeutic Response Portal)  &amp;  <strong>CMap</strong> (CMap-L1000v1)<br><strong>Input data types</strong>：<strong>mRNA</strong> EXP (before &amp; after treatment)</p>
</blockquote>
<h3 id="两个数据集的基本介绍："><a href="#两个数据集的基本介绍：" class="headerlink" title="两个数据集的基本介绍："></a>两个数据集的基本介绍：</h3><p><strong>CTRPv2</strong>：为860个细胞系和481个药物化合物的组合<strong>提供了不同药物浓度下细胞系的相对生存能力</strong>。细胞系对<strong>药物治疗的敏感性</strong>通过<strong>剂量-反应曲线AAC</strong>上方的面积来量化，我们进一步采用瀑布法对连续的AAC进行二值化（Barretina等人，2012；Haibe-Kains等人，2013），<strong>将灵敏度预测任务转化为离散的分类任务。</strong>  <del>体现在哪里？</del><br><strong>CMap</strong>：筛选了19 811种药物化合物对多达77个细胞系中<strong>L1000个标志性基因表达</strong>的干扰效应。<br>在CMap中的实验并<strong>不能测量药物治疗的敏感性</strong>，但是一些细胞系也在CTRPv2中进行了独立的测试。我们<strong>交叉</strong>引用这些细胞系(取交集)，并将相应的标签分配给它们的扰动测量。</p>
<h3 id="实验数据选择标准："><a href="#实验数据选择标准：" class="headerlink" title="实验数据选择标准："></a>实验数据选择标准：</h3><ol>
<li>从CMap数据集，选择了在<strong>最常见浓度水平下对每种药物进行6小时的微扰实验</strong>。(如果细胞系没有在选定的浓度下进行检测，我们使用最接近的检测浓度。接下来，我们将对照组（DMSO载体）实验与药物扰动实验通过批次ID和微珠ID进行匹配，以最小化病例和对照组之间的批次效应。<del>？</del> 此外，我们通过相关性（&gt;0.75 Pearson q）过滤所选的病例对照对，以过滤出可能标记错误的实验或异常值。)</li>
<li>CTRPv2和CMap-L1000v1数据集共有<strong>973</strong>个<strong>共同基因</strong>。将<strong>每个基因的表达值标准化为零均值和单位方差</strong>。为了进一步的均匀化，包括去除批效应和两个合并数据之间的差异，我们还从集合数据集中去除了第一个主成分（解释了12.8%的变化）。</li>
</ol>
<p>基于以上两个标准，我们选择了<strong>26</strong>种在CTRPv2和CMap-L1000v1数据集中测试的<strong>药物</strong>：</p>
<ul>
<li>对于每种选择的药物，至少有<strong>8个不同的细胞系在CMap干扰实验中测试。</strong></li>
<li>CTRPv2中至少有20%的筛选细胞系在剂量-反应AAC二值化后<strong>对药物敏感</strong>。</li>
</ul>
<p>（忽略后面的可以看一下第一列的药物）<br><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWctYmJzLmNzZG4ubmV0L3VwbG9hZC8yMDIwMDQvMDYvMTU4NjE1ODgwNV85NzAxNjAucG5n?x-oss-process=image/format,png#pic_center" alt="在这里插入图片描述"><br><em>代码体现</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## drug selection  </span></span><br><span class="line">drug_list_26 = [<span class="string">'omacetaxine mepesuccinate'</span>, <span class="string">'bortezomib'</span>, <span class="string">'vorinostat'</span>, <span class="string">'paclitaxel'</span>, <span class="string">'docetaxel'</span>, <span class="string">'topotecan'</span>,</span><br><span class="line">                <span class="string">'niclosamide'</span>, <span class="string">'valdecoxib'</span>,<span class="string">'teniposide'</span>, <span class="string">'vincristine'</span>, <span class="string">'prochlorperazine'</span>, <span class="string">'mitomycin'</span>, <span class="string">'lovastatin'</span>,</span><br><span class="line">                <span class="string">'gemcitabine'</span>, <span class="string">'dasatinib'</span>, <span class="string">'fluvastatin'</span>, <span class="string">'clofarabine'</span>, <span class="string">'sirolimus'</span>, <span class="string">'etoposide'</span>, <span class="string">'sitagliptin'</span>,</span><br><span class="line">                <span class="string">'decitabine'</span>, <span class="string">'PLX-4032'</span>, <span class="string">'fulvestrant'</span>, <span class="string">'bosutinib'</span>, <span class="string">'trifluoperazine'</span>, <span class="string">'ciclosporin'</span>]</span><br></pre></td></tr></table></figure>

<h2 id="7-交叉验证怎么做"><a href="#7-交叉验证怎么做" class="headerlink" title="7. 交叉验证怎么做?"></a>7. 交叉验证怎么做?</h2><p>通过执行20次重复的<strong>5折交叉验证</strong>，我们生成了100个训练验证测试数据。<br><em>代码体现</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSplitsByGroupKFold</span><span class="params">(groups, fold, n_splits, shuffle, random_state)</span>:</span></span><br><span class="line">    <span class="string">'''the same group will not appear in two different folds'''</span></span><br></pre></td></tr></table></figure>

<h2 id="8-Discussion："><a href="#8-Discussion：" class="headerlink" title="8. Discussion："></a>8. Discussion：</h2><p>典型的判别前馈神经网络在药物反应预测中效果不佳，很可能是由于数据限制（特征数量与样本数量）所致。 我们表明，<strong>药物反应和扰动效应的联合生成模型</strong>在很大程度上缓解了这种情况，<strong>可能起到了有效的正则化和鲁棒的特征提取的作用</strong>，而不会产生过拟合的情况。</p>
<h3 id="局限性："><a href="#局限性：" class="headerlink" title="局限性："></a>局限性：</h3><ol>
<li>只考虑基因表达方式，<strong>没有额外整合</strong>甲基化、拷贝数变化、相互作用状态的<strong>多组预测因子。</strong></li>
<li>我们在每种药物最常见的浓度水平下，对治疗6小时后的CMap-L1000v1扰动进行建模。有人认为，<strong>6小时太短，许多反馈调节机制无法体现自己，因此这些实验本身并不能提供完整的转录反应图片</strong>。值得注意的是，药物细胞系活力测定通常在较长的治疗时间（如72小时）内完成。因此，我们也用24小时的微扰实验来训练我们的VAE博士，然而，<strong>由于这样的实验数量有限</strong>，这并没有提高我们的预测性能。</li>
<li>Dr.VAE所组成的每一个条件分布都是由一个神经网络参数化的。调整超参数以匹配数据复杂性的能力使Dr.VAE成为一个非常灵活的模型。<strong>由于我们选择了简单性，我们的神经网络大多有一个隐藏层，而分类后验函数和扰动函数是线性的。</strong> 然而，到目前为止，我们试图通过更复杂的分布使用更深的网络或使用规范化流来近似后验的尝试，<strong>并没有显著地提高性能来证明增加的复杂性。</strong></li>
</ol>
<hr>
<h2 id="补充知识："><a href="#补充知识：" class="headerlink" title="补充知识："></a>补充知识：</h2><h3 id="ablation-study消融实验"><a href="#ablation-study消融实验" class="headerlink" title="ablation study消融实验:"></a>ablation study消融实验:</h3><p>论证是什么起了作用，类似于中学学的控制变量。模型简化测试。看看取消掉一些模块后性能有没有影响。<br>本实验通过 Dr.VAE w / I来验证<br><em>代码体现</em></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">forward_w_pert_identity</span><span class="params">(self, x1, x2, s=[])</span>:</span></span><br></pre></td></tr></table></figure>

<h3 id="Result部分"><a href="#Result部分" class="headerlink" title="Result部分"></a>Result部分</h3><p><em>代码体现</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">classif_baseline_perf</span><span class="params">(xtrain, ytrain, xtest, ytest, svmkernel=<span class="string">'rbf'</span>, rseed=None)</span>:</span></span><br><span class="line">    <span class="string">'''这个包括了和 Random Forest、LogisticRegression、SVM、SVM w/ linear kernel的对比'''</span></span><br><span class="line">    data = [xtrain, ytrain, xtest, ytest]</span><br><span class="line">    perf = OrderedDict()</span><br><span class="line"></span><br><span class="line">    <span class="comment">## Random Forest</span></span><br><span class="line">    cl = sklearn.ensemble.RandomForestClassifier(n_estimators=<span class="number">100</span>, random_state=rseed)</span><br><span class="line">    rf_perf = measure_cl_perf(cl, <span class="string">'RF100'</span>, *data)</span><br><span class="line">    perf = concat_dicts(perf, rf_perf)</span><br><span class="line"></span><br><span class="line">	<span class="comment">## LogisticRegression</span></span><br><span class="line">    cl = sklearn.linear_model.LogisticRegressionCV(penalty=<span class="string">'l2'</span>, random_state=rseed)</span><br><span class="line">    lr_perf = measure_cl_perf(cl, <span class="string">'Ridge'</span>, *data)</span><br><span class="line">    perf = concat_dicts(perf, lr_perf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">## SVM </span></span><br><span class="line">    cl = sklearn.svm.SVC(kernel=svmkernel, probability=<span class="literal">True</span>, random_state=rseed)</span><br><span class="line">    svm_perf = measure_cl_perf(cl, <span class="string">'SVM'</span> + svmkernel[:<span class="number">3</span>], *data)</span><br><span class="line">    perf = concat_dicts(perf, svm_perf)</span><br><span class="line">    <span class="comment"># SVM w/ linear kernel</span></span><br><span class="line">    cl = sklearn.svm.SVC(kernel=<span class="string">'linear'</span>, probability=<span class="literal">True</span>, random_state=rseed)</span><br><span class="line">    svm_perf = measure_cl_perf(cl, <span class="string">'SVMlin'</span>, *data)</span><br><span class="line">    perf = concat_dicts(perf, svm_perf)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> perf</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWctYmJzLmNzZG4ubmV0L3VwbG9hZC8yMDIwMDQvMDQvMTU4NTk5MzY5NF84MDQwMzYucG5n?x-oss-process=image/format,png#pic_center" alt="在这里插入图片描述"></p>
<h3 id="ELU激活函数"><a href="#ELU激活函数" class="headerlink" title="ELU激活函数"></a>ELU激活函数</h3><p><img src="https://img-blog.csdn.net/20161120172142224#pic_center" alt="在这里插入图片描述"><br><img src="https://img-blog.csdn.net/20160917160040231#pic_center" alt="在这里插入图片描述"><br>特点：</p>
<ul>
<li>融合了sigmoid和ReLU，左侧具有软饱和性，右侧无饱和性。</li>
<li>右侧线性部分使得ELU能够缓解梯度消失，而左侧软饱能够让ELU对输入变化或噪声更鲁棒。</li>
<li>ELU的输出均值接近于零，所以收敛速度更快。</li>
</ul>
<h3 id="MMD"><a href="#MMD" class="headerlink" title="MMD"></a>MMD</h3><p>MMD（最大均值差异）是迁移学习，尤其是Domain adaptation （域适应）中使用最广泛（目前）的一种损失函数，主要用来度量两个不同但相关的分布的距离。</p>
<h3 id="KL散度"><a href="#KL散度" class="headerlink" title="KL散度"></a>KL散度</h3><p>是一种量化两种概率分布P和Q之间差异的方式，又叫相对熵。K-L散度能帮助我们度量使用一个分布来近似另一个分布时所损失的信息量。</p>
<h3 id="细胞系"><a href="#细胞系" class="headerlink" title="细胞系"></a>细胞系</h3><p>细胞系（cell line）指原代细胞培养物经首次传代成功后所繁殖的细胞群体。 也指可长期连续传代的培养细胞。</p>
<h3 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h3><h4 id="文章："><a href="#文章：" class="headerlink" title="文章："></a>文章：</h4><p>(VAE)<a href="https://blog.csdn.net/weixin_40955254/article/details/82315224" target="_blank" rel="noopener">https://blog.csdn.net/weixin_40955254/article/details/82315224</a><br>(VAE)<a href="https://blog.csdn.net/cjh_jinduoxia/article/details/84995156" target="_blank" rel="noopener">https://blog.csdn.net/cjh_jinduoxia/article/details/84995156</a><br>(KL散度)<a href="https://www.jianshu.com/p/43318a3dc715?isappinstalled=0" target="_blank" rel="noopener">https://www.jianshu.com/p/43318a3dc715?isappinstalled=0</a></p>
<h4 id="视频："><a href="#视频：" class="headerlink" title="视频："></a>视频：</h4><p>（白板推导VAE）<a href="https://www.bilibili.com/video/BV15E411w7Pz" target="_blank" rel="noopener">https://www.bilibili.com/video/BV15E411w7Pz</a></p>
</div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-meta">本文作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Rr-shan</a></span></div><div class="post-copyright-type"><span class="post-copyright-meta">本文链接: </span><span class="post-copyright-info"><a href="https://rr-shan.github.io/2020/04/01/srf之论文阅读Dr.VAE/">https://rr-shan.github.io/2020/04/01/srf之论文阅读Dr.VAE/</a></span></div><div class="post-copyright-notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://rr-shan.github.io">Sanzzi</a>！</span></div></div></article><div id="pagination"><div class="prev-post pull-left"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="../../05/解析二级域名后看是否生效/"><i class="fas fa-angle-left">&nbsp;</i><span>解析二级域名后看是否生效</span></a></div><div class="next-post pull-right"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="../../../03/29/srf之论文汇报流程/"><span>srf之论文汇报流程</span><span>&nbsp;</span><i class="fas fa-angle-right"></i></a></div></div><!--div!= paginator()--></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fas fa-file-o"></i></span><span id="busuanzi_value_page_pv"></span><span></span></div><div class="copyright">&copy;2017 ～ 2020 By Rr-shan</div></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="../../../../js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="../../../../js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="../../../../js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="../../../../js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="../../../../js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="../../../../js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="../../../../js/scroll.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="../../../../js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="../../../../js/copy.js"></script><!--script(src=url)--><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/haruto.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>